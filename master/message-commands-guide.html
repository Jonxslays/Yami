<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Message commands &mdash; Yami &#34;0.4.0.post0&#34; documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/styles.css" type="text/css" />
      <link rel="stylesheet" href="_static/dark_mode_css/general.css" type="text/css" />
      <link rel="stylesheet" href="_static/dark_mode_css/dark.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/dark_mode_js/default_dark.js"></script>
        <script src="_static/dark_mode_js/theme_switcher.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Checks" href="checks-guide.html" />
    <link rel="prev" title="Getting started" href="getting-started-guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Yami
          </a>
              <div class="version">
                "0.4.0.post0"
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started-guide.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Message commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#create-a-message-command">Create a message command</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-message-subcommand">Create a message subcommand</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sub-subcommands">Sub-subcommands</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="checks-guide.html">Checks</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules-guide.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">API reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Yami</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Message commands</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/message-commands-guide.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="message-commands">
<h1>Message commands<a class="headerlink" href="#message-commands" title="Permalink to this headline"></a></h1>
<section id="create-a-message-command">
<h2>Create a message command<a class="headerlink" href="#create-a-message-command" title="Permalink to this headline"></a></h2>
<p>The bot listens for the
<a class="reference external" href="https://www.hikari-py.dev/hikari/events/message_events.html#hikari.events.message_events.MessageCreateEvent" title="(in hikari v2.0.0.dev108)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MessageCreateEvent</span></code></a> event. If the
message content begins with one of the bots prefixes and a command name
immediately following that, the bot will attempt to invoke the commands
callback.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Yami converts type hints in your callbacks function signature for
basic Python types automatically.</p>
<p>Convertible types:
<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a> <a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">complex</span></code></a> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code></a></p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@bot</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span> <span class="n">aliases</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;say&quot;</span><span class="p">],</span> <span class="n">invoke_with</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">echo_cmd</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">yami</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Echos what you said back to you.&quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-a-message-subcommand">
<h2>Create a message subcommand<a class="headerlink" href="#create-a-message-subcommand" title="Permalink to this headline"></a></h2>
<p>Subcommands in Yami do not have a special class. The only designation
they receive is the <code class="xref py py-obj docutils literal notranslate"><span class="pre">is_subcommand</span></code> and the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">parent</span></code> properties.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">subcommand</span></code> decorator should be used
as a method of the callback function of the parent command.</p>
<ul class="simple">
<li><p>Subcommands must also pass each <code class="xref py py-obj docutils literal notranslate"><span class="pre">Check</span></code> bound to its
parent commands.</p></li>
</ul>
</div>
<p>In this example the subcommand provides and optional interface to delete
the message sent by the parent command.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># continued from above...</span>

<span class="nd">@echo_cmd</span><span class="o">.</span><span class="n">subcommand</span><span class="p">(</span><span class="s2">&quot;-d&quot;</span><span class="p">,</span> <span class="n">aliases</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;--delete&quot;</span><span class="p">])</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">echo_delete_cmd</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">yami</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Optionally deletes the message after the given timeout.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">message</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s2">&quot;Something went wrong - no message to delete.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sub-subcommands">
<h2>Sub-subcommands<a class="headerlink" href="#sub-subcommands" title="Permalink to this headline"></a></h2>
<p>You can chain subcommands down as far as you would like. There is nothing
holding you back :).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Chaining subcommands does have some side effects to be aware of.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">allow_extra_args</span></code> kwarg for <code class="xref py py-obj docutils literal notranslate"><span class="pre">Bot</span></code> is very
helpful for allowing you to align the arguments of your
subcommands.</p></li>
<li><p>Yami disables the callback for all parent commands by default.
This can be set using the <code class="docutils literal notranslate"><span class="pre">invoke_with</span></code> kwarg in the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">yami.command</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">yami.Bot.command</span></code>, and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">yami.MessageCommand.subcommand</span></code> decorators.</p></li>
<li><p>Varying number and type for arguments in the command callbacks
can cause failures. Pay close attention to what type hints and
what argument positions you occupy in each callback, as well as
what defaults you set.</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">yami.MessageContext.shared</span></code> can be a powerful tool when used
to share information between parent commands and their
subcommands. Keep in mind that if something goes wrong in the
first callback, you may receive a <code class="xref py py-obj docutils literal notranslate"><span class="pre">SharedNone</span></code> if you
access an attribute that has not been set in a later subcommands
callback.</p></li>
</ul>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@bot</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">config_cmd</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">yami</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Configuration command.&quot;&quot;&quot;</span>
    <span class="o">...</span>

<span class="nd">@config_cmd</span><span class="o">.</span><span class="n">subcommand</span><span class="p">(</span><span class="s2">&quot;exp&quot;</span><span class="p">,</span> <span class="n">aliases</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;experience&quot;</span><span class="p">])</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">exp_subcmd</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">yami</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Configures server experience gain.&quot;&quot;&quot;</span>
    <span class="o">...</span>

<span class="nd">@exp_subcmd</span><span class="o">.</span><span class="n">subcommand</span><span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">exp_on_subcmd</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">yami</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Turns experience on.&quot;&quot;&quot;</span>
    <span class="o">...</span>

<span class="nd">@exp_subcmd</span><span class="o">.</span><span class="n">subcommand</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">exp_off_subcmd</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">yami</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Turns experience off.&quot;&quot;&quot;</span>
    <span class="o">...</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="getting-started-guide.html" class="btn btn-neutral float-left" title="Getting started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="checks-guide.html" class="btn btn-neutral float-right" title="Checks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021 Jonxslays.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>